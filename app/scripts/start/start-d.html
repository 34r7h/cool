<div class="start" ng-style="{display:'flex', maxHeight:'90vh'}">
    <img ng-style="{position:'absolute', zIndex:0, width:'100%', height:'100%'}" src="images/backdrop.jpg" alt="">
    <ui-view></ui-view>
</div>
<div ng-style="{position:'fixed', top:'65vh', width:'100%'}">
    <div ng-show="cool.di.state.gameStarted" ng-style="{display:'flex', width:'100vw'}">
        <div style="flex: 1 1 100%" ng-if="cool.di.state.players.length > 0 ">
            <div ng-style="{display:'flex', width:'100%'}">
                <span ng-repeat="player in cool.di.state.players"
                      ng-style="{padding:'0 1em', alignItems: 'center', height: $root.screen.height < 500 ? '1.5em' : '3em', background: cool.di.models.colors[player.color], border: player.playerName === cool.di.state.turn.playerName ? '2px groove black' : 'none',
                      width:'100%',
                      fontSize: $root.screen.width < 500 ? '1em' : $root.screen.width < 800 ? '1.25em' : '1.5em',
                      color: player.playerName === cool.di.state.turn.playerName ? 'white' : 'none',
                      textShadow: player.playerName === cool.di.state.turn.playerName ? '1px 1px 2px black' : 'none',
                      display:'flex', justifyContent:'space-between'}">
                    <span ng-click="secretDice = !secretDice">
                        {{player.playerName}}
                    </span>
                    <button ng-click="cool.di.state.liveTurn = false; cool.di.api.takeTurn(cool.di.state.players.indexOf(cool.di.state.turn), cool.di.state.turn)"
                            ng-show="cool.di.state.liveTurn && player.playerName == cool.di.state.turn.playerName">Roll</button>
                    <div ng-if="cool.di.state.gameStarted" ng-style="{display:'flex', height:'1em'}">
                        <span
                                ng-show="cool.di.state.liveTurn"
                                ng-if="player.playerName == cool.di.state.turn.playerName"
                                ng-repeat="die in cool.di.state.dice track by $index"
                                ng-style="{border:'2px solid #000', padding:'.5em', backgroundColor:'white', background:'url('+cool.di.models.dice[die]+')', backgroundSize:'cover'}">
                        </span>
                        <span
                                ng-hide="$parent.secretDice || cool.di.state.liveTurn"
                                ng-if="player.playerName == cool.di.state.turn.playerName"
                                ng-repeat="die in cool.di.state.dice track by $index"
                                ng-style="{border:'2px solid #000', padding:'.5em', backgroundColor:'white', background:'url('+cool.di.models.dice[die]+')', backgroundSize:'cover'}">
                        </span>
                        <span>
                                <label ng-show="secretDice && player === cool.di.state.turn"
                                       ng-style="{width:'40px', height:'40px', border:'none', margin:0, padding:0}">
                                    <b ng-click="cool.di.api.takeTurn(cool.di.state.players.indexOf(cool.di.state.turn), cool.di.state.turn, $parent.$parent.$parent.$root.die);">Cheat!</b>
                                    <input
                                            ng-style="{width:'40px', height:'40px', border:'none', margin:0, padding:0}"
                                            type="number" ng-model="$root.die[0]"
                                            ng-change="$root.die.total = $root.die[0] + $root.die[1]">
                                    <input
                                            ng-style="{width:'40px', height:'40px', border:'none', margin:0, padding:0}"
                                            type="number" ng-model="$root.die[1]"
                                            ng-change="$root.die.total = $root.die[0] + $root.die[1]">
                                </label>
                            </span>
                    </div>
                </span>
            </div>
        </div>
    </div>
    <div ng-show="!cool.di.state.gameStarted" ng-style="{background:'rgba(252,255,255,.7)', padding:'1em 3em'}">
        <div ng-if="!cool.di.state.gameStarted" ng-style="{textAlign:'center'}">
            <div ng-style="{display:'flex', width:'100%'}">
                <button ng-style="{fontSize:$root.screen.width < 700 ? '0.8em' : '1em', flex:'1'}"
                        ng-click="cool.di.api.startGame(1)">1 Player
                </button>
                <button ng-style="{fontSize:$root.screen.width < 700 ? '0.8em' : '1em', flex:'1'}"
                        ng-click="cool.di.api.startGame(2)">2 Players
                </button>
                <button ng-style="{fontSize:$root.screen.width < 700 ? '0.8em' : '1em', flex:'1'}"
                        ng-click="cool.di.api.startGame(3)">3 Players
                </button>
                <button ng-style="{fontSize:$root.screen.width < 700 ? '0.8em' : '1em', flex:'1'}"
                        ng-click="cool.di.api.startGame(4)">4 Players
                </button>
            </div>
        </div>
        <!--
                <button ng-click="$root.debug =! $root.debug">Debug?</button>
        -->
    </div>
</div>
<div ng-show="cool.di.state.messages.length > 0" ng-style="{bottom:'10%', position:'absolute', zIndex:9999, background:'rgba(255,255,255,.8)', padding:'1em'}">
    <div ng-style="{flex:'1 1 auto'}">
        <messages></messages>
    </div>
</div>
<div ng-style="{width:'100%', display:'flex', bottom:0, position:'fixed',zIndex:9999}">
    <h2 ng-style="{flex:'1 1 100%', padding:0, margin:0, textAlign: 'center'}">
        <a style="color:white" href ng-click="showReset =! showReset">Reset</a> /
        <a style="color:white" href ng-click="showRules = !showRules">Rules</a>
    </h2>
</div>
<rules ng-show="showRules"></rules>
<div ng-show="showReset"
     ng-style="{display:'flex',flexDirection:'column', justifyContent:'center',position:'absolute', width:'100%', height:'100%', background:'rgba(255,255,255,.89)', textAlign:'center'}">
    <button ng-style="{fontWeight:'bolder',fontSize:'2em' }" autofocus
            ng-click="cool.di.state.gameStarted = false; cool.di.api.killAudio(); showReset = !showReset">CONFIRM
        RESET
    </button>
    <a href ng-click="showReset = false">Cancel Reset</a>
</div>
<card></card>
<div ng-repeat="(famKey, family) in cool.di.models.audio">
    <audio id="{{$parent.famKey+'-'+trackKey}}" ng-repeat="(trackKey, track) in family"
           src="{{track.url + (track.time ? '#t='+track.time : '')}}" loop="{{track.loop}}"></audio>
</div>
<img ng-style="{position:'absolute', bottom:0, left:0, zIndex:0, width:'10vw', height:'auto'}" src="images/isitcool-logo.png" alt="">
