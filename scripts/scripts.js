"use strict";angular.module("cool",["ngAnimate","ngResource","ui.router"]),angular.module("cool").directive("board",function(){return{templateUrl:"scripts/board/board-d.html",restrict:"E"}}),angular.module("cool").directive("card",function(){return{templateUrl:"scripts/card/card-d.html",restrict:"EA"}}),angular.module("cool").directive("debug",function(){return{restrict:"E",transclude:!0,template:'<ng-transclude ng-if="$root.debug"></ng-transclude>'}}),angular.module("cool").factory("Api",["$state","State","$window","Models",function(o,e,r,t){var l={toNumber:function(o){return parseInt(o,10)},tForm:function(o){var e="";return angular.forEach(o,function(o,r){console.log(o,r),e+=r+"("+o+") "}),console.log(e),e},poly:function(o){var e="";return o?angular.forEach(o.split(" "),function(o){var t=o.split(",")[0],l=o.split(",")[1];console.log(t,l);var a=Math.floor(r.innerWidth/100*t),n=Math.floor(r.innerHeight/100*l);e+=a+","+n+" "}):null,console.log(e),e.length>0?e:null},nextPlayer:function(o){e.players[o+1]?(l.message({text:"moving on",header:"Next Player "+e.players[o+1].playerName}),e.turn=e.players[o+1]):(l.message({text:"moving on",header:"Next Player "+e.players[0].playerName}),e.turn=e.players[0])},movePlayer:function(o){function t(){return l.message({header:o.playerName,text:"choose direction!"}),e.direction=r.confirm(o.playerName+" rolled "+e.currentRoll+". Press OK to move forward. CANCEL to move backwards")}function a(e){l.message("moving",e?"up":"down"),e?o.currentPosition=o.currentPosition+1:o.currentPosition=o.currentPosition-1}var n=o.currentPosition,c=e.currentRoll;e.direction=!0,l.message({header:o.playerName+" is on "+n,text:"Rolled a "+c});for(var i=0;i<e.currentRoll;i++){if(17===n&&17===o.currentPosition||32===n&&32===o.currentPosition||50===n&&50===o.currentPosition)switch(l.message({header:o.playerName,text:"passing"}),o.currentPosition){case 17:o.currentPosition=24;break;case 32:o.currentPosition=38;break;case 50:o.currentPosition=51}else if(o.currentPosition>10&&o.currentPosition<24||o.currentPosition>=25&&o.currentPosition<38)switch((e.currentRoll-i===e.currentRoll||11===o.currentPosition&&11>=n||25===o.currentPosition&&25>=n)&&(e.direction=t()),o.currentPosition){case 11:e.direction?a(e.direction):o.currentPosition=23;break;case 23:e.direction?o.currentPosition=11:a(e.direction);break;case 25:e.direction?a(e.direction):o.currentPosition=37;break;case 37:e.direction?o.currentPosition=25:a(e.direction);break;default:a(e.direction)}else a(e.direction);if(o.currentPosition>50&&50!==n||o.currentPosition>58){o.currentPosition=41;break}}},rollDice:function(o,r){var t=0,a=!1,n=Math.floor(6*Math.random())+1;e.dice[0]=o||n;var c=Math.floor(6*Math.random())+1;return e.dice[1]=r||c,n===c?a=!0:null,o===r&&o+r>1?a=!0:null,t=o+r||n+c,e.currentRoll=t,e.turn.playerName?l.message({header:e.turn.playerName+" Rolls ",text:e.dice}):null,{total:t,doubles:a}},startGame:function(t){e.players=[];for(var a={},n={},c=0;t>c;c++){var i=r.prompt("What is player "+(c+1)+"'s name?");e.players.push({playerName:i,currentPosition:1})}angular.forEach(e.players,function(o,e){var r=l.rollDice().total;if(n[r]){for(var t=l.rollDice().total;n[t];)t=l.rollDice().total;n[t]=o.playerName,a[o.playerName]=t}else l.message({header:o.playerName,text:"has rolled "+r}),n[r]=o.playerName,a[o.playerName]=r});var s=[],u=[];angular.forEach(a,function(o,e){s.push(o)}),s.sort(function(o,e){return o-e}),angular.forEach(s,function(o){u.unshift({currentPosition:1,playerName:n[o]})});var p=["lightPurple","lightOrange","lightBlue","lightGreen","lightYellow","lightPink","pink"];angular.forEach(u,function(o){var e=Math.floor(Math.random()*(p.length-1));o.color=p[e],p.splice(e,1)}),e.players=u,e.turn=u[0],l.message({text:u[0].playerName+" goes first.",header:"Game ready to begin."}),o.go("cool.board"),e.gameStarted=!0},takeTurn:function(o,r,a){e.messages={},a?l.message({header:"Warning",text:r.playerName+" is a cheat!"}):null,l.message({header:r.playerName+" takes a turn.",text:"Rolling..."});var n=!1,c=a?l.rollDice(a[0],a[1]):l.rollDice();return"number"!=typeof r.currentPosition?void(c.doubles?r.currentPosition=1:l.nextPlayer(o)):(l.movePlayer(r,c.total),"cool?"===t.spaces[r.currentPosition]?(l.card(o),n=!0):"trap"===t.spaces[r.currentPosition]?(l.message({text:"Oh no, "+r.playerName+" sent back to start!",header:"It's a trap!!"}),l.goHome(r)):null,c.doubles===!0?(l.message({text:r.playerName+" goes again.",header:"Doubles!!"}),c.doubles=!1):(l.message({text:"next player is up.",header:r.playerName+"s turn is over"}),n?null:l.nextPlayer(o)),void(58===r.currentPosition&&(l.message({header:"Winner!!",text:r.playerName+" wins the game."}),e.gameStarted=!1)))},message:function(o){console.info(o.header,o.text);var r=Date.now();e.messages[r]={text:o.text,header:o.header,type:o.type,expires:r+o.duration}},card:function(){l.message({header:"Getting card",text:"Is it cool?"});var o=t.cards[Math.floor(Math.random()*t.cards.length)];e.card=o},goHome:function(o){l.message({header:"Going home",text:o.playerName+"Is it cool?"}),o.currentPosition=1},killPlayer:function(o){var r=e.players.indexOf(o);l.message({text:"Rough, son. Better luck on the next one",header:e.players[r].playerName+"is dead."}),l.nextPlayer(e.players.indexOf(o)),e.players.splice(r,1)},goPass:function(o){l.message({text:"Getting a pass, finishing fast!!",header:o.playerName+" is lucky."}),o.currentPosition<24?o.currentPosition=17:o.currentPosition>=24&&o.currentPosition<38&&(o.currentPosition=32),o.currentPosition>=38&&o.currentPosition<50&&(o.currentPosition=50),l.nextPlayer(e.players.indexOf(o))},goJail:function(o){l.message({text:"Getting sent to jail sucks, too bad now you're stuck!!",header:o.playerName+" is locked-up."}),o.currentPosition="jail",l.nextPlayer(e.players.indexOf(o))},goSchool:function(o){l.message({text:"Smarten up, level up",header:o.playerName+" is getting schooled."}),o.currentPosition="school",l.nextPlayer(e.players.indexOf(o))},goWork:function(o){l.message({text:"An empty wallet will get you nowhere fast",header:o.playerName+" gone broke!!"}),o.currentPosition="work",l.nextPlayer(e.players.indexOf(o))}};return l}]),angular.module("cool").factory("Models",function(){var o="",e=0,r=[],t={red:"rgba(180, 23, 2, 1)",blue:"rgba(1, 19, 108, 1)",yellow:"rgba(255, 203, 0, 1)",black:"rgba(0,1,2,1)",lightPurple:"rgba(119, 68, 150, 1)",lightOrange:"rgba(255, 87, 34, 1)",lightBlue:"rgba(0, 87, 171, 1)",lightGreen:"rgba(0, 234, 0, 1)",lightYellow:"rgba(255, 251, 0, 1)",lightPink:"rgba(255, 184, 191, 1)",pink:"rgba(255, 43, 106, 1)"},l={player:{name:o,currentPosition:e,color:o},message:{text:o,header:o,type:o,duration:e},card:{topText:[],bottomText:[],action:o,image:o},cards:[{topText:["You went to college","To be a boss","Then paid the cost","To be the boss"],bottomText:["That's cool!","You can go to pass"],action:"goPass",background:"green"},{topText:["You applied for a job","And got hired","They said you can work there","Until you retire!"],bottomText:["That's cool!","Go to pass"],action:"goPass",background:"green"},{topText:["You joined a gang and got shot and died. Then your family cried!"],bottomText:["That's not cool!","You're out of the game!","Sorry!"],action:"killPlayer",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/57/US_Capitol_Building_at_night_Jan_2006.jpg/1018px-US_Capitol_Building_at_night_Jan_2006.jpg"},{topText:["Locked in the can."],bottomText:["jailin"],action:"goJail",image:"http://www.liberalamerica.org/wp-content/uploads/2015/03/e15243d5-58a2-4215-8989-0d666bbb07d6.jpg"},{topText:["Locked in the can."],bottomText:["schoolin"],action:"goSchool",image:"https://www.google.com/url?sa=i&rct=j&q=&esrc=s&source=images&cd=&cad=rja&uact=8&ved=0ahUKEwjX4Ji27pvKAhVK5WMKHdKlCl4QjRwIBw&url=http%3A%2F%2Fwww.englishinbritain.co.uk%2Fschool_detail.cfm%3Fschoolid%3D421&bvm=bv.111396085,d.cGc&psig=AFQjCNGI9S-76H1wjc9C80PgZYGiFSy1oA&ust=1452399090198131"},{topText:["Locked in the can."],bottomText:["workin"],action:"goWork",image:"https://pixabay.com/static/uploads/photo/2014/07/05/10/31/work-384745_640.jpg"}],spaces:{school:{color:"school",tForm:{translateX:"45vw",translateY:"80vh"},poly:"50,0 51,0 51,1 51,0 50,0"},work:{color:"work",tForm:{translateY:"45vh"},poly:"0,48 0,52 4,52 4,48 0,48"},jail:{color:"jail",tForm:{translateX:"90vw",translateY:"45vh"},poly:"96,48 100,48 100,52 96,52 96,48"},1:{color:t.blue,poly:"13,5 8,5 10,11 12,11 13,5"},2:{color:t.yellow,poly:"8,5 4,8 7,13 10,11 8,5"},3:{color:t.black,poly:"4,8 1.8,13 5.5,16 7,13 4,8"},4:{color:t.red,poly:"1.8,13 0,19 5,19 5.5,16 1.8,13"},5:{color:"cool?",poly:"0,19 1,26 5.3,22.5 5,19 0,19"},6:{color:t.blue,poly:"1,26 3.5,31, 7,25 5.3,22.5 1,26"},7:{color:t.yellow,poly:"3.5,31 9,33 10,26 7,25 3.5,31"},8:{color:t.black,poly:"9,33 13,32 12,25.5 10,26 9,33"},9:{color:"cool?",poly:"13,32 18,28 15,24 12,25.5 13,32"},10:{color:t.red,poly:"18,28 21,25 20,20 15,24 18,28"},11:{color:t.blue,poly:"21,25 25,21 25.1,15 20,20 21,25"},12:{color:t.black,poly:"21,25 24.5,30 27,24 25,21 21,25"},13:{color:t.yellow,poly:"24.5,30 29,31.5 29.5,25 27,24 24.5,30"},14:{color:"cool?",poly:"29,31.5 34,31 32,25 29.5,25 29,31.5"},15:{color:t.black,poly:"34,31 37.5,27.5 34,23 32,25 34,31"},16:{color:t.yellow,poly:"37.5,27.5 41,19 35,21 34,23 37.5,27.5"},17:{color:"pass",poly:"41,19 40,13 35.5,15 35,21 41,19"},18:{color:t.black,poly:"40,13 37,8 34,12 35.5,15, 40,13"},19:{color:t.red,poly:"37,8 33,5 32,11 34,12 37,8"},20:{color:"cool?",poly:"33,5 28,5 29,11 32,11 33,5"},21:{color:t.yellow,poly:"28,5 23,8 27,12 29,11 28,5"},22:{color:t.black,poly:"23,8 21,12 25.1,15 27,12 23,8"},23:{color:"cool?",poly:"21,12 20,20 25.1,15 25.1,15 21,12"},24:{color:t.blue,poly:"41,19 44.5,18.5 45,13.5 40,13 41,19"},25:{color:t.red,poly:"44.5,18.5 50,21 49,15 45,13.5 44.5,18.5"},26:{color:t.yellow,poly:"50,21 51,22 47,26 44.5,18.5 50,21"},27:{color:t.blue,poly:"51,22 52,23 51,29 47,26 51,22"},28:{color:"cool?",poly:"51,29 56,30 54.5,23.5 52,23 51,29"},29:{color:t.black,poly:"56,30 60,28 57,23 54.5,23.5 56,30"},30:{color:t.yellow,poly:"60,28 63,25 59,21 57,23 60,28"},31:{color:t.red,poly:"63,25 64.5,19 60,18 59,21 63,25"},32:{color:"pass",poly:"64.5,19 64,13 60,15 60,18 64.5,19"},33:{color:t.blue,poly:"64,13 62,8 59,12 60,15 64,13"},34:{color:"cool?",poly:"62,8 57,4 56,10 59,12 62,8"},35:{color:t.black,poly:"57,4 52,4 53,9.5 56,10 57,4"},36:{color:t.yellow,poly:"52,4 47,8 51,12 53,9.5 52,4"},37:{color:"cool?",poly:"47,8 45,13.5 49,15 51,12 47,8"},38:{color:t.yellow,poly:"64.5,19 68.5,13.5 66,10 64,13 64.5,19"},39:{color:t.blue,poly:"68.5,13.5 71,9.5 69,6.5 66,10 68.5,13.5"},40:{color:t.black,poly:"71,9.5 72,7 71.5,3 69,6.5 71,9.5"},41:{color:t.red,poly:"72,7 76.5,6.5 76,2.5 71.5,3 72,7"},42:{color:"cool?",poly:"72,7 72.5,10.5 77,10.5 76.5,6.5 72,7"},43:{color:t.blue,poly:"72.5,10.5 73,15 77.5,14.5 77,10.5 72.5,10.5"},44:{color:t.yellow,poly:"73,15 73.5,19 78,19 77.5,14.5 73,15"},45:{color:t.red,poly:"73.5,19 74,25 78.5,22 78,19 73.5,19"},46:{color:"cool?",poly:"74,25 74.5,28.5 79,28 78.5,22 74,25"},47:{color:t.black,poly:"79,28 83,27.5 82,22 78.5,22 79,28"},48:{color:"trap",poly:"83,27.5 86,28 85.5,21.5 82,22 83,27.5"},50:{color:"pass",poly:"84,11 88,11 88.5,8 85,4.5 84,10"},51:{color:t.yellow,poly:"88.5,8 90,7 89.5,1.5 85,4.5 88.5,8"},52:{color:t.black,poly:"90,7 92,7.5 94,3.5 89.5,1.5 90,7"},53:{color:t.red,poly:"92,7.5 93,9.5 97.5,9.5 94,3.5 92,7.5"},54:{color:"cool?",poly:"93,9.5 92.5,12 96,16 97.5,9.5 93,9.5"},55:{color:t.blue,poly:"92.5,12 90,15.5 94,19 96,16 92.5,12"},56:{color:t.yellow,poly:"90,15.5 89.5,21 94,21 94,19 90,15.5"},57:{color:"trap",poly:"89.5,21 90.5,27 95,26.5 94,21 89.5,21"},58:{color:"win",poly:"88,35 94,30 100,35 100,45 94,50 88,45 88,35"}},sections:{timeouts:["school","work","jail"],c:[1,2,3,4,5,6,7,8,9,10],o1:[11,12,13,14,15,16,17,18,19,20,21,22,23],gap1:[24],o2:[25,26,27,28,29,30,31,32,33,34,35,36,37],gap2:[38,39,40],l:[41,42,43,44,45,46,47,48],question:[50,51,52,53,54,55,56,57],win:[58]},start:{players:e,colors:r,text:o},dice:[e,e],colors:t};return l}),angular.module("cool").factory("Rules",["State",function(o){var e={turnLogic:function(e,r,t){o.players[key+1]?o.turn=o.players[key+1]:o.turn=o.players[0]},cardLogic:function(){},winLogic:function(){}};return e}]),angular.module("cool").factory("State",function(){var o={turn:"",gameStarted:!1,players:[],messages:{},dice:[],card:{},direction:!0};return o}),angular.module("cool").directive("messages",function(){return{templateUrl:"scripts/messages/messages-d.html",restrict:"EA"}}),angular.module("cool").config(["$stateProvider","$urlRouterProvider",function(o,e){e.otherwise("/"),o.state("cool",{url:"/",template:"<start></start>",controller:coolCtrl,controllerAs:"cool"}).state("cool.board",{url:"board",template:"<board></board>"}).state("cool.board.space",{url:"/:space",template:"Space: Is it cool?"}).state("cool.cards",{url:"cards",template:"Cards: Is it cool?<ui-view></ui-view>"}).state("cool.cards.card",{url:"/:card",template:"Card: Is it cool?"})}]);var coolCtrl=function(o,e,r,t,l,a){var n=this;n.di={state:o,rules:e,api:r,models:t,window:l,sce:a},n.cool="very"};coolCtrl.$inject=["State","Rules","Api","Models","$window","$sce"],angular.module("cool").directive("start",function(){return{templateUrl:"scripts/start/start-d.html",restrict:"E"}});