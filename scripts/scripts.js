"use strict";angular.module("cool",["ngAnimate","ngResource","ui.router"]),angular.module("cool").directive("board",function(){return{templateUrl:"scripts/board/board-d.html",restrict:"E"}}),angular.module("cool").directive("card",function(){return{templateUrl:"scripts/card/card-d.html",restrict:"EA"}}),angular.module("cool").directive("debug",function(){return{restrict:"E",transclude:!0,template:'<ng-transclude ng-if="$root.debug"></ng-transclude>'}}),angular.module("cool").factory("Api",["$state","State","$window","Models",function(o,e,r,t){var a={tForm:function(o){var e="";return angular.forEach(o,function(o,r){console.log(o,r),e+=r+"("+o+") "}),console.log(e),e},nextPlayer:function(o){e.players[o+1]?(a.message({text:"moving on",header:"Next Player "+e.players[o+1].playerName}),e.turn=e.players[o+1]):(a.message({text:"moving on",header:"Next Player "+e.players[0].playerName}),e.turn=e.players[0])},movePlayer:function(o){function t(){return a.message({header:o.playerName,text:"choose direction!"}),e.direction=r.confirm(o.playerName+" rolled "+e.currentRoll+". Press OK to move forward. CANCEL to move backwards")}function l(e){a.message("moving",e?"up":"down"),e?o.currentPosition=o.currentPosition+1:o.currentPosition=o.currentPosition-1}var n=o.currentPosition,i=e.currentRoll;e.direction=!0,a.message({header:o.playerName+" is on "+n,text:"Rolled a "+i});for(var c=0;c<e.currentRoll;c++){if(17===n&&17===o.currentPosition||32===n&&32===o.currentPosition||50===n&&50===o.currentPosition)switch(a.message({header:o.playerName,text:"passing"}),o.currentPosition){case 17:o.currentPosition=24;break;case 32:o.currentPosition=38;break;case 50:o.currentPosition=51}else if(o.currentPosition>10&&o.currentPosition<24||o.currentPosition>=25&&o.currentPosition<38)switch((e.currentRoll-c===e.currentRoll||11===o.currentPosition&&11>=n||25===o.currentPosition&&25>=n)&&(e.direction=t()),o.currentPosition){case 11:e.direction?l(e.direction):o.currentPosition=23;break;case 23:e.direction?o.currentPosition=11:l(e.direction);break;case 25:e.direction?l(e.direction):o.currentPosition=37;break;case 37:e.direction?o.currentPosition=25:l(e.direction);break;default:l(e.direction)}else l(e.direction);if(o.currentPosition>50&&50!==n||o.currentPosition>58){o.currentPosition=41;break}}},rollDice:function(o,r){var t=0,l=!1,n=Math.floor(6*Math.random())+1;e.dice[0]=o||n;var i=Math.floor(6*Math.random())+1;return e.dice[1]=r||i,n===i?l=!0:null,o===r&&o+r>1?l=!0:null,t=o+r||n+i,e.currentRoll=t,e.turn.playerName?a.message({header:e.turn.playerName+" Rolls ",text:e.dice}):null,{total:t,doubles:l}},startGame:function(t){e.players=[];for(var l={},n={},i=0;t>i;i++){var c=r.prompt("What is player "+(i+1)+"'s name?");e.players.push({playerName:c,currentPosition:1})}angular.forEach(e.players,function(o,e){var r=a.rollDice().total;if(n[r]){for(var t=a.rollDice().total;n[t];)t=a.rollDice().total;n[t]=o.playerName,l[o.playerName]=t}else a.message({header:o.playerName,text:"has rolled "+r}),n[r]=o.playerName,l[o.playerName]=r});var s=[],u=[];angular.forEach(l,function(o,e){s.push(o)}),s.sort(function(o,e){return o-e}),angular.forEach(s,function(o){u.unshift({currentPosition:1,playerName:n[o]})});var d=["lightPurple","lightOrange","lightBlue","lightGreen","lightYellow","lightPink","pink"];angular.forEach(u,function(o){var e=Math.floor(Math.random()*(d.length-1));o.color=d[e],d.splice(e,1)}),e.players=u,e.turn=u[0],a.message({text:u[0].playerName+" goes first.",header:"Game ready to begin."}),o.go("cool.board"),e.gameStarted=!0},takeTurn:function(o,r,l){e.messages={},l?a.message({header:"Warning",text:r.playerName+" is a cheat!"}):null,a.message({header:r.playerName+" takes a turn.",text:"Rolling..."});var n=!1,i=l?a.rollDice(l[0],l[1]):a.rollDice();return"number"!=typeof r.currentPosition?void(i.doubles?r.currentPosition=1:a.nextPlayer(o)):(a.movePlayer(r,i.total),"cool?"===t.spaces[r.currentPosition]?(a.card(o),n=!0):"trap"===t.spaces[r.currentPosition]?(a.message({text:"Oh no, "+r.playerName+" sent back to start!",header:"It's a trap!!"}),a.goHome(r)):null,i.doubles===!0?(a.message({text:r.playerName+" goes again.",header:"Doubles!!"}),i.doubles=!1):(a.message({text:"next player is up.",header:r.playerName+"s turn is over"}),n?null:a.nextPlayer(o)),void(58===r.currentPosition&&(a.message({header:"Winner!!",text:r.playerName+" wins the game."}),e.gameStarted=!1)))},message:function(o){console.info(o.header,o.text);var r=Date.now();e.messages[r]={text:o.text,header:o.header,type:o.type,expires:r+o.duration}},card:function(){a.message({header:"Getting card",text:"Is it cool?"});var o=t.cards[Math.floor(Math.random()*t.cards.length)];e.card=o},goHome:function(o){a.message({header:"Going home",text:o.playerName+"Is it cool?"}),o.currentPosition=1},killPlayer:function(o){var r=e.players.indexOf(o);a.message({text:"Rough, son. Better luck on the next one",header:e.players[r].playerName+"is dead."}),a.nextPlayer(e.players.indexOf(o)),e.players.splice(r,1)},goPass:function(o){a.message({text:"Getting a pass, finishing fast!!",header:o.playerName+" is lucky."}),o.currentPosition<24?o.currentPosition=17:o.currentPosition>=24&&o.currentPosition<38&&(o.currentPosition=32),o.currentPosition>=38&&o.currentPosition<50&&(o.currentPosition=50),a.nextPlayer(e.players.indexOf(o))},goJail:function(o){a.message({text:"Getting sent to jail sucks, too bad now you're stuck!!",header:o.playerName+" is locked-up."}),o.currentPosition="jail",a.nextPlayer(e.players.indexOf(o))},goSchool:function(o){a.message({text:"Smarten up, level up",header:o.playerName+" is getting schooled."}),o.currentPosition="school",a.nextPlayer(e.players.indexOf(o))},goWork:function(o){a.message({text:"An empty wallet will get you nowhere fast",header:o.playerName+" gone broke!!"}),o.currentPosition="work",a.nextPlayer(e.players.indexOf(o))}};return a}]),angular.module("cool").factory("Models",function(){var o="",e=0,r=[],t={red:"rgba(180, 23, 2, 1)",blue:"rgba(1, 19, 108, 1)",yellow:"rgba(255, 203, 0, 1)",black:"rgba(0,1,2,1)",lightPurple:"rgba(119, 68, 150, 1)",lightOrange:"rgba(255, 87, 34, 1)",lightBlue:"rgba(0, 87, 171, 1)",lightGreen:"rgba(0, 234, 0, 1)",lightYellow:"rgba(255, 251, 0, 1)",lightPink:"rgba(255, 184, 191, 1)",pink:"rgba(255, 43, 106, 1)"},a={player:{name:o,currentPosition:e,color:o},message:{text:o,header:o,type:o,duration:e},card:{topText:[],bottomText:[],action:o,image:o},cards:[{topText:["You went to college","To be a boss","Then paid the cost","To be the boss"],bottomText:["That's cool!","You can go to pass"],action:"goPass",background:"green"},{topText:["You applied for a job","And got hired","They said you can work there","Until you retire!"],bottomText:["That's cool!","Go to pass"],action:"goPass",background:"green"},{topText:["You joined a gang and got shot and died. Then your family cried!"],bottomText:["That's not cool!","You're out of the game!","Sorry!"],action:"killPlayer",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/57/US_Capitol_Building_at_night_Jan_2006.jpg/1018px-US_Capitol_Building_at_night_Jan_2006.jpg"},{topText:["Locked in the can."],bottomText:["jailin"],action:"goJail",image:"http://www.liberalamerica.org/wp-content/uploads/2015/03/e15243d5-58a2-4215-8989-0d666bbb07d6.jpg"},{topText:["Locked in the can."],bottomText:["schoolin"],action:"goSchool",image:"https://www.google.com/url?sa=i&rct=j&q=&esrc=s&source=images&cd=&cad=rja&uact=8&ved=0ahUKEwjX4Ji27pvKAhVK5WMKHdKlCl4QjRwIBw&url=http%3A%2F%2Fwww.englishinbritain.co.uk%2Fschool_detail.cfm%3Fschoolid%3D421&bvm=bv.111396085,d.cGc&psig=AFQjCNGI9S-76H1wjc9C80PgZYGiFSy1oA&ust=1452399090198131"},{topText:["Locked in the can."],bottomText:["workin"],action:"goWork",image:"https://pixabay.com/static/uploads/photo/2014/07/05/10/31/work-384745_640.jpg"}],spaces:{school:{color:"school",tForm:{translateX:"45vw",translateY:"80vh"}},work:{color:"work",tForm:{translateY:"45vh"}},jail:{color:"jail",tForm:{translateX:"90vw",translateY:"45vh"}},1:{color:t.blue,origin:{top:"65%",left:"13%"},tForm:{rotate:"-21deg"}},2:{color:t.yellow,origin:{top:"66.5%",left:"8.5%"},tForm:{rotate:"-35deg"}},3:{color:t.black,origin:{top:"70%",left:"6%"},tForm:{rotate:"-72deg"}},4:{color:t.red,origin:{top:"75%",left:"5.5%"},tForm:{rotate:"0deg"}},5:{color:"cool?",origin:{top:"80%",left:"6%"},tForm:{rotate:"-21deg"}},6:{color:t.blue,origin:{top:"84%",left:"9.5%"},tForm:{rotate:"-35deg"}},7:{color:t.yellow,origin:{top:"86%",left:"13.5%"},tForm:{rotate:"-72deg"}},8:{color:t.black,origin:{top:"85%",left:"17.5%"},tForm:{rotate:"-21deg"}},9:{color:"cool?"},10:{color:t.red},11:{color:t.blue},12:{color:t.black},13:{color:t.yellow},14:{color:"cool?"},15:{color:t.black},16:{color:t.yellow},17:{color:"pass"},18:{color:t.black},19:{color:t.red},20:{color:"cool?"},21:{color:t.yellow},22:{color:t.black},23:{color:"cool?"},24:{color:t.blue},25:{color:t.red},26:{color:t.yellow},27:{color:t.blue},28:{color:"cool?"},29:{color:t.black},30:{color:t.yellow},31:{color:t.red},32:{color:"pass"},33:{color:t.blue},34:{color:"cool?"},35:{color:t.black},36:{color:t.yellow},37:{color:"cool?"},38:{color:t.yellow},39:{color:t.blue},40:{color:t.black},41:{color:t.red},42:{color:"cool?"},43:{color:t.blue},44:{color:t.yellow},45:{color:t.red},46:{color:"cool?"},47:{color:t.black},48:{color:"trap"},49:{color:"sunglasses"},50:{color:"pass"},51:{color:t.yellow},52:{color:t.black},53:{color:t.red},54:{color:"cool?"},55:{color:t.blue},56:{color:t.yellow},57:{color:"trap"},58:{color:"win"}},sections:{timeouts:["school","work","jail"],c:[1,2,3,4,5,6,7,8,9,10],o1:[11,12,13,14,15,16,17,18,19,20,21,22,23],gap1:[24],o2:[25,26,27,28,29,30,31,32,33,34,35,36,37],gap2:[38,39,40],l:[41,42,43,44,45,46,47,48],sunglasses:[49],question:[50,51,52,53,54,55,56,57],win:[58]},start:{players:e,colors:r,text:o},dice:[e,e],colors:t};return a}),angular.module("cool").factory("Rules",["State",function(o){var e={turnLogic:function(e,r,t){o.players[key+1]?o.turn=o.players[key+1]:o.turn=o.players[0]},cardLogic:function(){},winLogic:function(){}};return e}]),angular.module("cool").factory("State",function(){var o={turn:"",gameStarted:!1,players:[],messages:{},dice:[],card:{},direction:!0};return o}),angular.module("cool").directive("messages",function(){return{templateUrl:"scripts/messages/messages-d.html",restrict:"EA"}}),angular.module("cool").config(["$stateProvider","$urlRouterProvider",function(o,e){e.otherwise("/"),o.state("cool",{url:"/",template:"<start></start>",controller:coolCtrl,controllerAs:"cool"}).state("cool.board",{url:"board",template:"<board></board>"}).state("cool.board.space",{url:"/:space",template:"Space: Is it cool?"}).state("cool.cards",{url:"cards",template:"Cards: Is it cool?<ui-view></ui-view>"}).state("cool.cards.card",{url:"/:card",template:"Card: Is it cool?"})}]);var coolCtrl=function(o,e,r,t){var a=this;a.di={state:o,rules:e,api:r,models:t},a.cool="very"};coolCtrl.$inject=["State","Rules","Api","Models"],angular.module("cool").directive("start",function(){return{templateUrl:"scripts/start/start-d.html",restrict:"E"}});