"use strict";angular.module("cool",["ngAnimate","ngResource","ui.router"]),angular.module("cool").directive("board",function(){return{templateUrl:"scripts/board/board-d.html",restrict:"E"}}),angular.module("cool").directive("card",function(){return{templateUrl:"scripts/card/card-d.html",restrict:"EA"}}),angular.module("cool").directive("debug",function(){return{restrict:"E",transclude:!0,template:'<ng-transclude ng-if="$root.debug"></ng-transclude>'}}),angular.module("cool").factory("Api",["$state","State","$window","Models",function(e,o,t,r){var a={nextPlayer:function(e){o.players[e+1]?(a.message({text:"moving on",header:"Next Player "+o.players[e+1].playerName}),o.turn=o.players[e+1]):(a.message({text:"moving on",header:"Next Player "+o.players[0].playerName}),o.turn=o.players[0])},movePlayer:function(e){function r(){return console.log("choosing direction"),o.direction=t.confirm(e.playerName+" rolled "+o.currentRoll+". Press OK to move forward. CANCEL to move backwards")}function l(o){console.warn("moving",o),o?e.currentPosition=e.currentPosition+1:e.currentPosition=e.currentPosition-1}var n=e.currentPosition,i=o.currentRoll;o.direction=!0,a.message({header:e.playerName+" is on "+n,text:"Rolled a "+i});for(var s=0;s<o.currentRoll;s++)if(17===n&&17===e.currentPosition||32===n&&32===e.currentPosition||50===n&&50===e.currentPosition)switch(console.log(e.playerName,"passing"),e.currentPosition){case 17:e.currentPosition=24;break;case 32:e.currentPosition=38;break;case 50:e.currentPosition=51}else if(e.currentPosition>10&&e.currentPosition<24||e.currentPosition>=25&&e.currentPosition<38)switch((o.currentRoll-s===o.currentRoll||11===e.currentPosition&&11>=n||25===e.currentPosition&&25>=n)&&(o.direction=r()),e.currentPosition){case 11:o.direction?l(o.direction):e.currentPosition=23;break;case 23:o.direction?e.currentPosition=11:l(o.direction);break;case 25:o.direction?l(o.direction):e.currentPosition=37;break;case 37:o.direction?e.currentPosition=25:l(o.direction);break;default:l(o.direction)}else{if(e.currentPosition>50&&50>n||e.currentPosition>58){e.currentPosition=41;break}console.warn("default movement"),l(o.direction)}},rollDice:function(e,t){e||t?console.log("%s cheats","background:red;color:white;"):null;var r=0,l=!1,n=Math.floor(6*Math.random())+1;o.dice[0]=e||n;var i=Math.floor(6*Math.random())+1;return o.dice[1]=t||i,n===i?l=!0:null,e===t&&e+t>1?l=!0:null,r=e+t||n+i,o.currentRoll=r,a.message({header:o.turn.playerName+" Rolls ",text:o.dice}),{total:r,doubles:l}},startGame:function(r){o.players=[];for(var l={},n={},i=0;r>i;i++){console.log("startGame() - get names",i);var s=t.prompt("What is player "+(i+1)+"'s name?");o.players.push({playerName:s,currentPosition:1})}angular.forEach(o.players,function(e,o){console.info(o,e);var t=a.rollDice().total;if(console.info(n[t]),n[t]){for(var r=a.rollDice().total;n[r];)console.error("Tied! Rolling Again"),console.info("player "+e.playerName+" has rolled the same and will now re-roll"),r=a.rollDice().total;n[r]=e.playerName,l[e.playerName]=r}else console.info(e.playerName+" has rolled "+t),n[t]=e.playerName,l[e.playerName]=t}),console.log(l);var c=[],u=[];angular.forEach(l,function(e,o){c.push(e)}),c.sort(function(e,o){return e-o}),angular.forEach(c,function(e){u.unshift({currentPosition:1,playerName:n[e]})}),console.log("%c",u,"color:#00ff00");var d=["lightPurple","lightOrange","lightBlue","lightGreen","lightYellow","lightPink","pink"];angular.forEach(u,function(e){var o=Math.floor(Math.random()*(d.length-1));e.color=d[o],d.splice(o,1)}),o.players=u,o.turn=u[0],console.log("%c Game ready to begin. Player "+u[0].playerName+" goes first.","font-size:2em"),a.message({text:u[0].playerName+" goes first.",header:"Game ready to begin."}),e.go("cool.board"),o.gameStarted=!0},takeTurn:function(e,t,l){o.messages={},l?a.message({header:"Warning",text:t.playerName+" is a cheat!"}):null,a.message({header:t.playerName+" takes a turn.",text:"Rolling..."});var n=!1,i=l?a.rollDice(l[0],l[1]):a.rollDice();return"number"!=typeof t.currentPosition?(console.log("not a number"),void(i.doubles?t.currentPosition=1:a.nextPlayer(e))):(a.movePlayer(t,i.total),"cool?"===r.spaces[t.currentPosition]?(a.card(e),n=!0):"trap"===r.spaces[t.currentPosition]?(console.log("Its a trap!!"),a.message({text:"Oh no, "+t.playerName+" sent back to start!",header:"It's a trap!!"}),a.goHome(t)):null,i.doubles===!0?(console.log("player "+t.playerName+" goes again."),a.message({text:t.playerName+" goes again.",header:"Doubles!!"})):(a.message({text:"next player is up.",header:t.playerName+"s turn is over"}),n?null:a.nextPlayer(e)),void(58===t.currentPosition&&(a.message({header:"Winner!!",text:t.playerName+" wins the game."}),o.gameStarted=!1)))},message:function(e){console.info(e.header,e.text);var t=Date.now();o.messages[t]={text:e.text,header:e.header,type:e.type,expires:t+e.duration}},card:function(){a.message({header:"Getting card",text:"Is it cool?"});var e=r.cards[Math.floor(Math.random()*r.cards.length)];o.card=e},goHome:function(e){a.message({header:"Going home",text:e.playerName+"Is it cool?"}),e.currentPosition=1},killPlayer:function(e){var t=o.players.indexOf(e);a.message({text:"Rough, son. Better luck on the next one",header:o.players[t].playerName+"is dead."}),a.nextPlayer(o.players.indexOf(e)),o.players.splice(t,1)},goPass:function(e){console.log("getting a pass, ya baby!!"),a.message({text:"Getting a pass, finishing fast!!",header:e.playerName+" is lucky."}),e.currentPosition<24?e.currentPosition=17:e.currentPosition>=24&&e.currentPosition<38&&(e.currentPosition=32),e.currentPosition>=38&&e.currentPosition<50&&(e.currentPosition=50),a.nextPlayer(o.players.indexOf(e))},goJail:function(e){a.message({text:"Getting sent to jail sucks, too bad now you're stuck!!",header:e.playerName+" is locked-up."}),e.currentPosition="jail",a.nextPlayer(o.players.indexOf(e))},goSchool:function(e){a.message({text:"Smarten up, level up",header:e.playerName+" is getting schooled."}),e.currentPosition="school",a.nextPlayer(o.players.indexOf(e))},goWork:function(e){a.message({text:"An empty wallet will get you nowhere fast",header:e.playerName+" gone broke!!"}),e.currentPosition="work",a.nextPlayer(o.players.indexOf(e))}};return a}]),angular.module("cool").factory("Models",function(){var e="",o=0,t=[],r={red:"rgba(180, 23, 2, 1)",blue:"rgba(1, 19, 108, 1)",yellow:"rgba(255, 203, 0, 1)",black:"rgba(0,1,2,1)",lightPurple:"rgba(119, 68, 150, 1)",lightOrange:"rgba(255, 87, 34, 1)",lightBlue:"rgba(0, 87, 171, 1)",lightGreen:"rgba(0, 234, 0, 1)",lightYellow:"rgba(255, 251, 0, 1)",lightPink:"rgba(255, 184, 191, 1)",pink:"rgba(255, 43, 106, 1)"},a={player:{name:e,currentPosition:o,color:e},message:{text:e,header:e,type:e,duration:o},card:{topText:[],bottomText:[],action:e,image:e},cards:[{topText:["You went to college","To be a boss","Then paid the cost","To be the boss"],bottomText:["That's cool!","You can go to pass"],action:"goPass",background:"green"},{topText:["You applied for a job","And got hired","They said you can work there","Until you retire!"],bottomText:["That's cool!","Go to pass"],action:"goPass",background:"green"},{topText:["You joined a gang and got shot and died. Then your family cried!"],bottomText:["That's not cool!","You're out of the game!","Sorry!"],action:"killPlayer",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/57/US_Capitol_Building_at_night_Jan_2006.jpg/1018px-US_Capitol_Building_at_night_Jan_2006.jpg"},{topText:["Locked in the can."],bottomText:["jailin"],action:"goJail",image:"http://www.liberalamerica.org/wp-content/uploads/2015/03/e15243d5-58a2-4215-8989-0d666bbb07d6.jpg"},{topText:["Locked in the can."],bottomText:["schoolin"],action:"goSchool",image:"https://www.google.com/url?sa=i&rct=j&q=&esrc=s&source=images&cd=&cad=rja&uact=8&ved=0ahUKEwjX4Ji27pvKAhVK5WMKHdKlCl4QjRwIBw&url=http%3A%2F%2Fwww.englishinbritain.co.uk%2Fschool_detail.cfm%3Fschoolid%3D421&bvm=bv.111396085,d.cGc&psig=AFQjCNGI9S-76H1wjc9C80PgZYGiFSy1oA&ust=1452399090198131"},{topText:["Locked in the can."],bottomText:["workin"],action:"goWork",image:"https://pixabay.com/static/uploads/photo/2014/07/05/10/31/work-384745_640.jpg"}],spaces:{school:"school",work:"work",jail:"jail",1:r.blue,2:r.yellow,3:r.black,4:r.red,5:"cool?",6:r.blue,7:r.yellow,8:r.black,9:"cool?",10:r.red,11:r.blue,12:r.black,13:r.yellow,14:"cool?",15:r.black,16:r.yellow,17:"pass",18:r.black,19:r.red,20:"cool?",21:r.yellow,22:r.black,23:"cool?",24:r.blue,25:r.red,26:r.yellow,27:r.blue,28:"cool?",29:r.black,30:r.yellow,31:r.red,32:"pass",33:r.blue,34:"cool?",35:r.black,36:r.yellow,37:"cool?",38:r.yellow,39:r.blue,40:r.black,41:r.red,42:"cool?",43:r.blue,44:r.yellow,45:r.red,46:"cool?",47:r.black,48:"trap",49:"sunglasses",50:"pass",51:r.yellow,52:r.black,53:r.red,54:"cool?",55:r.blue,56:r.yellow,57:"trap",58:"win"},sections:{timeouts:["school","work","jail"],c:[1,2,3,4,5,6,7,8,9,10],o1:[11,12,13,14,15,16,17,18,19,20,21,22,23],gap1:[24],o2:[25,26,27,28,29,30,31,32,33,34,35,36,37],gap2:[38,39,40],l:[41,42,43,44,45,46,47,48],sunglasses:[49],question:[50,51,52,53,54,55,56,57],win:[58]},start:{players:o,colors:t,text:e},dice:[o,o],colors:r};return a}),angular.module("cool").factory("Rules",["State",function(e){var o={turnLogic:function(o,t,r){e.players[key+1]?e.turn=e.players[key+1]:e.turn=e.players[0]},cardLogic:function(){},winLogic:function(){}};return o}]),angular.module("cool").factory("State",function(){var e={turn:"",gameStarted:!1,players:[],messages:{},dice:[],card:{},direction:!0};return e}),angular.module("cool").directive("messages",function(){return{templateUrl:"scripts/messages/messages-d.html",restrict:"EA"}}),angular.module("cool").config(["$stateProvider","$urlRouterProvider",function(e,o){o.otherwise("/"),e.state("cool",{url:"/",template:"<start></start>",controller:coolCtrl,controllerAs:"cool"}).state("cool.board",{url:"board",template:"<board></board>"}).state("cool.board.space",{url:"/:space",template:"Space: Is it cool?"}).state("cool.cards",{url:"cards",template:"Cards: Is it cool?<ui-view></ui-view>"}).state("cool.cards.card",{url:"/:card",template:"Card: Is it cool?"})}]);var coolCtrl=function(e,o,t,r){var a=this;a.di={state:e,rules:o,api:t,models:r},a.cool="very"};coolCtrl.$inject=["State","Rules","Api","Models"],angular.module("cool").directive("start",function(){return{templateUrl:"scripts/start/start-d.html",restrict:"E"}});