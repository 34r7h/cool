"use strict";angular.module("cool",["ngAnimate","ngResource","ui.router"]),angular.module("cool").directive("board",function(){return{templateUrl:"scripts/board/board-d.html",restrict:"E"}}),angular.module("cool").directive("card",function(){return{templateUrl:"scripts/card/card-d.html",restrict:"EA"}}),angular.module("cool").directive("debug",function(){return{restrict:"E",transclude:!0,template:'<ng-transclude ng-if="$root.debug"></ng-transclude>'}}),angular.module("cool").factory("Api",["$state","State","$window","Models",function(e,t,o,r){var a={nextPlayer:function(e){t.players[e+1]?(a.message({text:"moving on",header:"Next Player "+t.players[e+1].playerName}),t.turn=t.players[e+1]):(a.message({text:"moving on",header:"Next Player "+t.players[0].playerName}),t.turn=t.players[0])},movePlayer:function(e){function r(){return a.message({header:e.playerName,text:"choose direction!"}),t.direction=o.confirm(e.playerName+" rolled "+t.currentRoll+". Press OK to move forward. CANCEL to move backwards")}function l(t){a.message("moving",t?"up":"down"),t?e.currentPosition=e.currentPosition+1:e.currentPosition=e.currentPosition-1}var n=e.currentPosition,i=t.currentRoll;t.direction=!0,a.message({header:e.playerName+" is on "+n,text:"Rolled a "+i});for(var s=0;s<t.currentRoll;s++){if(17===n&&17===e.currentPosition||32===n&&32===e.currentPosition||50===n&&50===e.currentPosition)switch(a.message({header:e.playerName,text:"passing"}),e.currentPosition){case 17:e.currentPosition=24;break;case 32:e.currentPosition=38;break;case 50:e.currentPosition=51}else if(e.currentPosition>10&&e.currentPosition<24||e.currentPosition>=25&&e.currentPosition<38)switch((t.currentRoll-s===t.currentRoll||11===e.currentPosition&&11>=n||25===e.currentPosition&&25>=n)&&(t.direction=r()),e.currentPosition){case 11:t.direction?l(t.direction):e.currentPosition=23;break;case 23:t.direction?e.currentPosition=11:l(t.direction);break;case 25:t.direction?l(t.direction):e.currentPosition=37;break;case 37:t.direction?e.currentPosition=25:l(t.direction);break;default:l(t.direction)}else l(t.direction);if(e.currentPosition>50&&50!==n||e.currentPosition>58){e.currentPosition=41;break}}},rollDice:function(e,o){var r=0,l=!1,n=Math.floor(6*Math.random())+1;t.dice[0]=e||n;var i=Math.floor(6*Math.random())+1;return t.dice[1]=o||i,n===i?l=!0:null,e===o&&e+o>1?l=!0:null,r=e+o||n+i,t.currentRoll=r,t.turn.playerName?a.message({header:t.turn.playerName+" Rolls ",text:t.dice}):null,{total:r,doubles:l}},startGame:function(r){t.players=[];for(var l={},n={},i=0;r>i;i++){var s=o.prompt("What is player "+(i+1)+"'s name?");t.players.push({playerName:s,currentPosition:1})}angular.forEach(t.players,function(e,t){var o=a.rollDice().total;if(n[o]){for(var r=a.rollDice().total;n[r];)r=a.rollDice().total;n[r]=e.playerName,l[e.playerName]=r}else a.message({header:e.playerName,text:"has rolled "+o}),n[o]=e.playerName,l[e.playerName]=o});var c=[],u=[];angular.forEach(l,function(e,t){c.push(e)}),c.sort(function(e,t){return e-t}),angular.forEach(c,function(e){u.unshift({currentPosition:1,playerName:n[e]})});var d=["lightPurple","lightOrange","lightBlue","lightGreen","lightYellow","lightPink","pink"];angular.forEach(u,function(e){var t=Math.floor(Math.random()*(d.length-1));e.color=d[t],d.splice(t,1)}),t.players=u,t.turn=u[0],a.message({text:u[0].playerName+" goes first.",header:"Game ready to begin."}),e.go("cool.board"),t.gameStarted=!0},takeTurn:function(e,o,l){t.messages={},l?a.message({header:"Warning",text:o.playerName+" is a cheat!"}):null,a.message({header:o.playerName+" takes a turn.",text:"Rolling..."});var n=!1,i=l?a.rollDice(l[0],l[1]):a.rollDice();return"number"!=typeof o.currentPosition?void(i.doubles?o.currentPosition=1:a.nextPlayer(e)):(a.movePlayer(o,i.total),"cool?"===r.spaces[o.currentPosition]?(a.card(e),n=!0):"trap"===r.spaces[o.currentPosition]?(a.message({text:"Oh no, "+o.playerName+" sent back to start!",header:"It's a trap!!"}),a.goHome(o)):null,i.doubles===!0?(a.message({text:o.playerName+" goes again.",header:"Doubles!!"}),i.doubles=!1):(a.message({text:"next player is up.",header:o.playerName+"s turn is over"}),n?null:a.nextPlayer(e)),void(58===o.currentPosition&&(a.message({header:"Winner!!",text:o.playerName+" wins the game."}),t.gameStarted=!1)))},message:function(e){console.info(e.header,e.text);var o=Date.now();t.messages[o]={text:e.text,header:e.header,type:e.type,expires:o+e.duration}},card:function(){a.message({header:"Getting card",text:"Is it cool?"});var e=r.cards[Math.floor(Math.random()*r.cards.length)];t.card=e},goHome:function(e){a.message({header:"Going home",text:e.playerName+"Is it cool?"}),e.currentPosition=1},killPlayer:function(e){var o=t.players.indexOf(e);a.message({text:"Rough, son. Better luck on the next one",header:t.players[o].playerName+"is dead."}),a.nextPlayer(t.players.indexOf(e)),t.players.splice(o,1)},goPass:function(e){a.message({text:"Getting a pass, finishing fast!!",header:e.playerName+" is lucky."}),e.currentPosition<24?e.currentPosition=17:e.currentPosition>=24&&e.currentPosition<38&&(e.currentPosition=32),e.currentPosition>=38&&e.currentPosition<50&&(e.currentPosition=50),a.nextPlayer(t.players.indexOf(e))},goJail:function(e){a.message({text:"Getting sent to jail sucks, too bad now you're stuck!!",header:e.playerName+" is locked-up."}),e.currentPosition="jail",a.nextPlayer(t.players.indexOf(e))},goSchool:function(e){a.message({text:"Smarten up, level up",header:e.playerName+" is getting schooled."}),e.currentPosition="school",a.nextPlayer(t.players.indexOf(e))},goWork:function(e){a.message({text:"An empty wallet will get you nowhere fast",header:e.playerName+" gone broke!!"}),e.currentPosition="work",a.nextPlayer(t.players.indexOf(e))}};return a}]),angular.module("cool").factory("Models",function(){var e="",t=0,o=[],r={red:"rgba(180, 23, 2, 1)",blue:"rgba(1, 19, 108, 1)",yellow:"rgba(255, 203, 0, 1)",black:"rgba(0,1,2,1)",lightPurple:"rgba(119, 68, 150, 1)",lightOrange:"rgba(255, 87, 34, 1)",lightBlue:"rgba(0, 87, 171, 1)",lightGreen:"rgba(0, 234, 0, 1)",lightYellow:"rgba(255, 251, 0, 1)",lightPink:"rgba(255, 184, 191, 1)",pink:"rgba(255, 43, 106, 1)"},a={player:{name:e,currentPosition:t,color:e},message:{text:e,header:e,type:e,duration:t},card:{topText:[],bottomText:[],action:e,image:e},cards:[{topText:["You went to college","To be a boss","Then paid the cost","To be the boss"],bottomText:["That's cool!","You can go to pass"],action:"goPass",background:"green"},{topText:["You applied for a job","And got hired","They said you can work there","Until you retire!"],bottomText:["That's cool!","Go to pass"],action:"goPass",background:"green"},{topText:["You joined a gang and got shot and died. Then your family cried!"],bottomText:["That's not cool!","You're out of the game!","Sorry!"],action:"killPlayer",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/57/US_Capitol_Building_at_night_Jan_2006.jpg/1018px-US_Capitol_Building_at_night_Jan_2006.jpg"},{topText:["Locked in the can."],bottomText:["jailin"],action:"goJail",image:"http://www.liberalamerica.org/wp-content/uploads/2015/03/e15243d5-58a2-4215-8989-0d666bbb07d6.jpg"},{topText:["Locked in the can."],bottomText:["schoolin"],action:"goSchool",image:"https://www.google.com/url?sa=i&rct=j&q=&esrc=s&source=images&cd=&cad=rja&uact=8&ved=0ahUKEwjX4Ji27pvKAhVK5WMKHdKlCl4QjRwIBw&url=http%3A%2F%2Fwww.englishinbritain.co.uk%2Fschool_detail.cfm%3Fschoolid%3D421&bvm=bv.111396085,d.cGc&psig=AFQjCNGI9S-76H1wjc9C80PgZYGiFSy1oA&ust=1452399090198131"},{topText:["Locked in the can."],bottomText:["workin"],action:"goWork",image:"https://pixabay.com/static/uploads/photo/2014/07/05/10/31/work-384745_640.jpg"}],spaces:{school:"school",work:"work",jail:"jail",1:r.blue,2:r.yellow,3:r.black,4:r.red,5:"cool?",6:r.blue,7:r.yellow,8:r.black,9:"cool?",10:r.red,11:r.blue,12:r.black,13:r.yellow,14:"cool?",15:r.black,16:r.yellow,17:"pass",18:r.black,19:r.red,20:"cool?",21:r.yellow,22:r.black,23:"cool?",24:r.blue,25:r.red,26:r.yellow,27:r.blue,28:"cool?",29:r.black,30:r.yellow,31:r.red,32:"pass",33:r.blue,34:"cool?",35:r.black,36:r.yellow,37:"cool?",38:r.yellow,39:r.blue,40:r.black,41:r.red,42:"cool?",43:r.blue,44:r.yellow,45:r.red,46:"cool?",47:r.black,48:"trap",49:"sunglasses",50:"pass",51:r.yellow,52:r.black,53:r.red,54:"cool?",55:r.blue,56:r.yellow,57:"trap",58:"win"},sections:{timeouts:["school","work","jail"],c:[1,2,3,4,5,6,7,8,9,10],o1:[11,12,13,14,15,16,17,18,19,20,21,22,23],gap1:[24],o2:[25,26,27,28,29,30,31,32,33,34,35,36,37],gap2:[38,39,40],l:[41,42,43,44,45,46,47,48],sunglasses:[49],question:[50,51,52,53,54,55,56,57],win:[58]},start:{players:t,colors:o,text:e},dice:[t,t],colors:r};return a}),angular.module("cool").factory("Rules",["State",function(e){var t={turnLogic:function(t,o,r){e.players[key+1]?e.turn=e.players[key+1]:e.turn=e.players[0]},cardLogic:function(){},winLogic:function(){}};return t}]),angular.module("cool").factory("State",function(){var e={turn:"",gameStarted:!1,players:[],messages:{},dice:[],card:{},direction:!0};return e}),angular.module("cool").directive("messages",function(){return{templateUrl:"scripts/messages/messages-d.html",restrict:"EA"}}),angular.module("cool").config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/"),e.state("cool",{url:"/",template:"<start></start>",controller:coolCtrl,controllerAs:"cool"}).state("cool.board",{url:"board",template:"<board></board>"}).state("cool.board.space",{url:"/:space",template:"Space: Is it cool?"}).state("cool.cards",{url:"cards",template:"Cards: Is it cool?<ui-view></ui-view>"}).state("cool.cards.card",{url:"/:card",template:"Card: Is it cool?"})}]);var coolCtrl=function(e,t,o,r){var a=this;a.di={state:e,rules:t,api:o,models:r},a.cool="very"};coolCtrl.$inject=["State","Rules","Api","Models"],angular.module("cool").directive("start",function(){return{templateUrl:"scripts/start/start-d.html",restrict:"E"}});